#include "stm32f4xx.h"
#include "variables.h"
#include <math.h>


/***********************************************************************/
//                          Structure declarations
/***********************************************************************/

// ADC READINGS
volatile uint16_t adc_buffer[ADC_LENGHT];
volatile struct Adc_Readings adc_read={0};

// COUNTERS
volatile struct Counters counters     ={0};
volatile bool relayOff_counter_enable = 0;
volatile uint32_t tick_counter        = 0;       // USED IN TESTING

// PLL
volatile struct PLL_Variables pll = {
    .Theta          = 0.0f,
    .freq           = 0.0f,
    .freq_ff        = 50.0f,
    .Vq_out_filtered= 0.0f,
    .theta_prev     = 0.0f,
    .integrator     = 0.0f,
    .Vq_prev        = 0.0f,
    .Vq_filtered    = 0.0f,
    .cos_theta      = 0.0f,
    .sin_theta      = 0.0f,
    .error          = 0.0f,
    .max_corr_rad   = 0.0f,
    .w_corr         = 0.0f,
    .w_nom          = 0.0f,
    .w              = 0.0f,
    .w_min          = 0.0f,
    .w_max          = 0.0f,
    .alpha          = 0.005f,
    .Kp             = 0.6f,
    .Ki             = 15.12f,
	.intialized     = 0,
	.Ts             = 100e-6f,
	.debugVariable1 = 0.0f,
	.debugVariable2 = 0.0f,
	.lockCount      = 0,
	.treshold_time  = 100000,
};

// GRID
volatile struct V_Grid_Variables grid = {
		.Ia     = 606.0f,
		.Ib     = 606.0f,
		.Ic     = 100.0f,
		.Va     = 0.0f,
		.Vb     = 0.0f,
		.Vc     = 0.0f,
		.V_alpha= 0.0f,
		.V_beta = 0.0f,
		.Id     = 0.0f,
		.Iq     = 0.0f,
		.Vd     = 0.0f,
		.Vq     = 0.0f,
};

// TIM3
volatile struct Timer3_Variables timer3_variables={
	.sample_index   = 0,
	.Tim3_ARR_Value = 50,
};

//INSTANTENOUS
volatile struct Instantaneous_Variables instVal={0.0f};

// RMS CALCULATIONS
volatile struct Rms_Calculations rms_calculations={0};
volatile struct Rms_Calculations final_squared_sum={0};
volatile struct Avg_of_mean_square avg_of_mean_square={0};
volatile struct RMS_Variables rmsVal={0.0f};

// AVERAGE CALCULATIONS
volatile struct Avg_Calculations avg_calculations={0};
volatile struct Avg_Calculations final_sum ={0};
volatile struct Average_Variables avgVal={0.0f};

// DIAGNOSTICS
// Upper Cut-Off Limits
volatile struct Limit_Parameters UCoffLimit = {
    .Va_rms  = 400,
    .Vb_rms  = 400,
    .Vc_rms  = 400,
    .Va_inst = 450,
    .Vb_inst = 450,
    .Vc_inst = 450,
    .Ia_rms  = 80,
    .Ib_rms  = 80,
    .Ic_rms  = 80,
    .Ia_inst = 120,
    .Ib_inst = 120,
    .Ic_inst = 120,
    .Vdc_avg = 500,
    .Vdc_inst= 500,
    .Idc_avg = 150,
    .Idc_inst= 150
};

// Upper Cut-In Limits
volatile struct Limit_Parameters UCinLimit = {
    .Va_rms  = 350,
    .Vb_rms  = 350,
    .Vc_rms  = 350,
    .Ia_rms  = 75,
    .Ib_rms  = 75,
    .Ic_rms  = 75,
    .Vdc_avg = 450,
    .Idc_avg = 120,
};

// Lower Cut-Off Limits
volatile struct Limit_Parameters LCoffLimit = {
	.Va_rms  = 100,
	.Vb_rms  = 100,
	.Vc_rms  = 100,
	.Va_inst = -450,
	.Vb_inst = -450,
	.Vc_inst = -450,
	.Ia_rms  = 60,
	.Ib_rms  = 60,
    .Ic_rms  = 60,
	.Ia_inst = -120,
	.Ib_inst = -120,
	.Ic_inst = -120,
    .Vdc_avg = 70,
    .Vdc_inst= 50,
    .Idc_avg = 2,
    .Idc_inst= 2
};

// Lower Cut-In Limits
volatile struct Limit_Parameters LCinLimit = {
    .Va_rms  = 200,
    .Vb_rms  = 200,
    .Vc_rms  = 200,
    .Ia_rms  = 65,
    .Ib_rms  = 65,
    .Ic_rms  = 65,
    .Vdc_avg = 70,
    .Idc_avg = 50,
};

// ERROR FLAGS
volatile struct ErrorFlags error_flags={0};

// STATE CONTROL
volatile StateControl state = state0;
volatile uint32_t first_time_state_entry=0;

//Voltage Control-parameters
volatile struct Voltage_Controller_Variables voltage_ctrl = {
	.Vdc_ref          = 700.0f,
	.Vdc_actual       = 700.0f,
	.Id_ref_max       = 10.0f,
	.Id_ref           = 0.0f,
	.I_term_clamped   = 0.0f,
	.integral_error   = 0.0f,
	.I_term_candidate = 0.0f,
	.P_term           = 0.0f,
	.error            = 0.0f,
	.Kp               = 0.5f,
	.Ki               = 100.0f,

};

//Current Control-parameters
volatile struct Current_Controller_Variables current_ctrl={
		.L        = 0.0f,
		.C        = 0.0f,
		.Vd_ff    = 0.0f,
		.Vq_ff    = 0.0f,
		.Iq_ref   = 0.0f,
		.Id       = 0.0f,
		.Iq       = 0.0f,
		.Vd_out   = 0.0f,
		.Vq_out   = 0.0f,
		.deltaV_d = 0.0f,
		.deltaV_q = 0.0f,
		.Vlimit   = 30.0f,
		.err_Id   = 0.0f,
		.err_Iq   = 0.0f,
		.int_Id   = 0.0f,
		.int_Iq   = 0.0f,
		.Kp       = 50.5f,
		.Ki       = 100.0f
};

// DQ TO ABC
volatile struct dq_to_abc abc_form={0};


//volatile bool rms_calculation_busy_flag = 0;
//volatile bool avg_calculation_busy_flag = 0;
//volatile bool rms_calculation_req = 0;
//volatile bool avg_calculation_req = 0;
//volatile int n = 0;
//volatile int m = 0;
//volatile int final_N = 0;
//volatile int final_M = 0;
//volatile float theta_prev = 0;
//volatile float theta = 0;

/***********************************************************************/
//                          PLL Va, Vb, Vc Array
/***********************************************************************/
const float va_array[]= {
	    0.0f, 6.980962575f, 13.95979868f, 20.9343825f, 27.9025895f, 34.8622971f,
	    41.81138531f, 48.74773736f, 55.66924038f, 62.57378602f, 69.45927107f,
	    76.32359815f, 83.16467633f, 89.98042174f, 96.76875824f, 103.527618f,
	    110.2549423f, 116.9486819f, 123.6067977f, 130.2272618f, 136.8080573f,
	    143.3471798f, 149.8426374f, 156.2924514f, 162.6946572f, 169.0473047f,
	    175.3484587f, 181.5961999f, 187.7886251f, 193.9238481f, 200.0f,
	    206.01523f, 211.9677057f, 217.855614f, 223.6771614f, 229.4305745f,
	    235.1141009f, 240.7260093f, 246.2645901f, 251.7281564f, 257.1150439f,
	    262.4236116f, 267.6522425f, 272.799344f, 277.8633482f, 282.8427125f,
	    287.7359201f, 292.5414806f, 297.2579302f, 301.8838321f, 306.4177772f,
	    310.8583846f, 315.2043014f, 319.454204f, 323.6067977f, 327.6608177f,
	    331.615029f, 335.4682272f, 339.2192385f, 342.8669203f, 346.4101615f,
	    349.8478829f, 353.1790371f, 356.4026097f, 359.5176185f, 362.5231148f,
	    365.4181831f, 368.2019414f, 370.8735418f, 373.4321706f, 375.8770483f,
	    378.2074302f, 380.4226065f, 382.5219024f, 384.5046784f, 386.3703305f,
	    388.1182905f, 389.7480259f, 391.2590403f, 392.6508734f, 393.9231012f,
	    395.0753362f, 396.1072275f, 397.0184607f, 397.8087581f, 398.4778792f,
	    399.0256201f, 399.4518139f, 399.7563308f, 399.9390781f, 400.0f,
	    399.9390781f, 399.7563308f, 399.4518139f, 399.0256201f, 398.4778792f,
	    397.8087581f, 397.0184607f, 396.1072275f, 395.0753362f, 393.9231012f,
	    392.6508734f, 391.2590403f, 389.7480259f, 388.1182905f, 386.3703305f,
	    384.5046784f, 382.5219024f, 380.4226065f, 378.2074302f, 375.8770483f,
	    373.4321706f, 370.8735418f, 368.2019414f, 365.4181831f, 362.5231148f,
	    359.5176185f, 356.4026097f, 353.1790371f, 349.8478829f, 346.4101615f,
	    342.8669203f, 339.2192385f, 335.4682272f, 331.615029f, 327.6608177f,
	    323.6067977f, 319.454204f, 315.2043014f, 310.8583846f, 306.4177772f,
	    301.8838321f, 297.2579302f, 292.5414806f, 287.7359201f, 282.8427125f,
	    277.8633482f, 272.799344f, 267.6522425f, 262.4236116f, 257.1150439f,
	    251.7281564f, 246.2645901f, 240.7260093f, 235.1141009f, 229.4305745f,
	    223.6771614f, 217.855614f, 211.9677057f, 206.01523f, 200.0f,
	    193.9238481f, 187.7886251f, 181.5961999f, 175.3484587f, 169.0473047f,
	    162.6946572f, 156.2924514f, 149.8426374f, 143.3471798f, 136.8080573f,
	    130.2272618f, 123.6067977f, 116.9486819f, 110.2549423f, 103.527618f,
	    96.76875824f, 89.98042174f, 83.16467633f, 76.32359815f, 69.45927107f,
	    62.57378602f, 55.66924038f, 48.74773736f, 41.81138531f, 34.8622971f,
	    27.9025895f, 20.9343825f, 13.95979868f, 6.980962575f, 0.0f,
	   -6.980962575f, -13.95979868f, -20.9343825f, -27.9025895f, -34.8622971f,
	   -41.81138531f, -48.74773736f, -55.66924038f, -62.57378602f, -69.45927107f,
	   -76.32359815f, -83.16467633f, -89.98042174f, -96.76875824f, -103.527618f,
	   -110.2549423f, -116.9486819f, -123.6067977f, -130.2272618f, -136.8080573f,
	   -143.3471798f, -149.8426374f, -156.2924514f, -162.6946572f, -169.0473047f,
	   -175.3484587f, -181.5961999f, -187.7886251f, -193.9238481f, -200.0f,
	   -206.01523f, -211.9677057f, -217.855614f, -223.6771614f, -229.4305745f,
	   -235.1141009f, -240.7260093f, -246.2645901f, -251.7281564f, -257.1150439f,
	   -262.4236116f, -267.6522425f, -272.799344f, -277.8633482f, -282.8427125f,
	   -287.7359201f, -292.5414806f, -297.2579302f, -301.8838321f, -306.4177772f,
	   -310.8583846f, -315.2043014f, -319.454204f, -323.6067977f, -327.6608177f,
	   -331.615029f, -335.4682272f, -339.2192385f, -342.8669203f, -346.4101615f,
	   -349.8478829f, -353.1790371f, -356.4026097f, -359.5176185f, -362.5231148f,
	   -365.4181831f, -368.2019414f, -370.8735418f, -373.4321706f, -375.8770483f,
	   -378.2074302f, -380.4226065f, -382.5219024f, -384.5046784f, -386.3703305f,
	   -388.1182905f, -389.7480259f, -391.2590403f, -392.6508734f, -393.9231012f,
	   -395.0753362f, -396.1072275f, -397.0184607f, -397.8087581f, -398.4778792f,
	   -399.0256201f, -399.4518139f, -399.7563308f, -399.9390781f, -400.0f,
	   -399.9390781f, -399.7563308f, -399.4518139f, -399.0256201f, -398.4778792f,
	   -397.8087581f, -397.0184607f, -396.1072275f, -395.0753362f, -393.9231012f,
	   -392.6508734f, -391.2590403f, -389.7480259f, -388.1182905f, -386.3703305f,
	   -384.5046784f, -382.5219024f, -380.4226065f, -378.2074302f, -375.8770483f,
	   -373.4321706f, -370.8735418f, -368.2019414f, -365.4181831f, -362.5231148f,
	   -359.5176185f, -356.4026097f, -353.1790371f, -349.8478829f, -346.4101615f,
	   -342.8669203f, -339.2192385f, -335.4682272f, -331.615029f, -327.6608177f,
	   -323.6067977f, -319.454204f, -315.2043014f, -310.8583846f, -306.4177772f,
	   -301.8838321f, -297.2579302f, -292.5414806f, -287.7359201f, -282.8427125f,
	   -277.8633482f, -272.799344f, -267.6522425f, -262.4236116f, -257.1150439f,
	   -251.7281564f, -246.2645901f, -240.7260093f, -235.1141009f, -229.4305745f,
	   -223.6771614f, -217.855614f, -211.9677057f, -206.01523f, -200.0f,
	   -193.9238481f, -187.7886251f, -181.5961999f, -175.3484587f, -169.0473047f,
	   -162.6946572f, -156.2924514f, -149.8426374f, -143.3471798f, -136.8080573f,
	   -130.2272618f, -123.6067977f, -116.9486819f, -110.2549423f, -103.527618f,
	   -96.76875824f, -89.98042174f, -83.16467633f, -76.32359815f, -69.45927107f,
	   -62.57378602f, -55.66924038f, -48.74773736f, -41.81138531f, -34.8622971f,
	   -27.9025895f, -20.9343825f, -13.95979868f, -6.980962575f
	};



const float vb_array[]= {
	    -346.4101615f, -349.8478829f, -353.1790371f, -356.4026097f, -359.5176185f, -362.5231148f,
	    -365.4181831f, -368.2019414f, -370.8735418f, -373.4321706f, -375.8770483f, -378.2074302f,
	    -380.4226065f, -382.5219024f, -384.5046784f, -386.3703305f, -388.1182905f, -389.7480259f,
	    -391.2590403f, -392.6508734f, -393.9231012f, -395.0753362f, -396.1072275f, -397.0184607f,
	    -397.8087581f, -398.4778792f, -399.0256201f, -399.4518139f, -399.7563308f, -399.9390781f,
	    -400.0000000f, -399.9390781f, -399.7563308f, -399.4518139f, -399.0256201f, -398.4778792f,
	    -397.8087581f, -397.0184607f, -396.1072275f, -395.0753362f, -393.9231012f, -392.6508734f,
	    -391.2590403f, -389.7480259f, -388.1182905f, -386.3703305f, -384.5046784f, -382.5219024f,
	    -380.4226065f, -378.2074302f, -375.8770483f, -373.4321706f, -370.8735418f, -368.2019414f,
	    -365.4181831f, -362.5231148f, -359.5176185f, -356.4026097f, -353.1790371f, -349.8478829f,
	    -346.4101615f, -342.8669203f, -339.2192385f, -335.4682272f, -331.6150290f, -327.6608177f,
	    -323.6067977f, -319.4542040f, -315.2043014f, -310.8583846f, -306.4177772f, -301.8838321f,
	    -297.2579302f, -292.5414806f, -287.7359201f, -282.8427125f, -277.8633482f, -272.7993440f,
	    -267.6522425f, -262.4236116f, -257.1150439f, -251.7281564f, -246.2645901f, -240.7260093f,
	    -235.1141009f, -229.4305745f, -223.6771614f, -217.8556140f, -211.9677057f, -206.0152300f,
	    -200.0000000f, -193.9238481f, -187.7886251f, -181.5961999f, -175.3484587f, -169.0473047f,
	    -162.6946572f, -156.2924514f, -149.8426374f, -143.3471798f, -136.8080573f, -130.2272618f,
	    -123.6067977f, -116.9486819f, -110.2549423f, -103.5276180f,  -96.7687582f,  -89.9804217f,
	     -83.1646763f,  -76.3235981f,  -69.4592711f,  -62.5737860f,  -55.6692404f,  -48.7477374f,
	     -41.8113853f,  -34.8622971f,  -27.9025895f,  -20.9343825f,  -13.9597987f,   -6.9809626f,
	       0.0000000f,    6.9809626f,   13.9597987f,   20.9343825f,   27.9025895f,   34.8622971f,
	      41.8113853f,   48.7477374f,   55.6692404f,   62.5737860f,   69.4592711f,   76.3235981f,
	      83.1646763f,   89.9804217f,   96.7687582f,  103.5276180f,  110.2549423f,  116.9486819f,
	     123.6067977f,  130.2272618f,  136.8080573f,  143.3471798f,  149.8426374f,  156.2924514f,
	     162.6946572f,  169.0473047f,  175.3484587f,  181.5961999f,  187.7886251f,  193.9238481f,
	     200.0000000f,  206.0152300f,  211.9677057f,  217.8556140f,  223.6771614f,  229.4305745f,
	     235.1141009f,  240.7260093f,  246.2645901f,  251.7281564f,  257.1150439f,  262.4236116f,
	     267.6522425f,  272.7993440f,  277.8633482f,  282.8427125f,  287.7359201f,  292.5414806f,
	     297.2579302f,  301.8838321f,  306.4177772f,  310.8583846f,  315.2043014f,  319.4542040f,
	     323.6067977f,  327.6608177f,  331.6150290f,  335.4682272f,  339.2192385f,  342.8669203f,
	     346.4101615f,  349.8478829f,  353.1790371f,  356.4026097f,  359.5176185f,  362.5231148f,
	     365.4181831f,  368.2019414f,  370.8735418f,  373.4321706f,  375.8770483f,  378.2074302f,
	     380.4226065f,  382.5219024f,  384.5046784f,  386.3703305f,  388.1182905f,  389.7480259f,
	     391.2590403f,  392.6508734f,  393.9231012f,  395.0753362f,  396.1072275f,  397.0184607f,
	     397.8087581f,  398.4778792f,  399.0256201f,  399.4518139f,  399.7563308f,  399.9390781f,
	     400.0000000f,  399.9390781f,  399.7563308f,  399.4518139f,  399.0256201f,  398.4778792f,
	     397.8087581f,  397.0184607f,  396.1072275f,  395.0753362f,  393.9231012f,  392.6508734f,
	     391.2590403f,  389.7480259f,  388.1182905f,  386.3703305f,  384.5046784f,  382.5219024f,
	     380.4226065f,  378.2074302f,  375.8770483f,  373.4321706f,  370.8735418f,  368.2019414f,
	     365.4181831f,  362.5231148f,  359.5176185f,  356.4026097f,  353.1790371f,  349.8478829f,
	     346.4101615f,  342.8669203f,  339.2192385f,  335.4682272f,  331.6150290f,  327.6608177f,
	     323.6067977f,  319.4542040f,  315.2043014f,  310.8583846f,  306.4177772f,  301.8838321f,
	     297.2579302f,  292.5414806f,  287.7359201f,  282.8427125f,  277.8633482f,  272.7993440f,
	     267.6522425f,  262.4236116f,  257.1150439f,  251.7281564f,  246.2645901f,  240.7260093f,
	     235.1141009f,  229.4305745f,  223.6771614f,  217.8556140f,  211.9677057f,  206.0152300f,
	     200.0000000f,  193.9238481f,  187.7886251f,  181.5961999f,  175.3484587f,  169.0473047f,
	     162.6946572f,  156.2924514f,  149.8426374f,  143.3471798f,  136.8080573f,  130.2272618f,
	     123.6067977f,  116.9486819f,  110.2549423f,  103.5276180f,   96.7687582f,   89.9804217f,
	      83.1646763f,   76.3235981f,   69.4592711f,   62.5737860f,   55.6692404f,   48.7477374f,
	      41.8113853f,   34.8622971f,   27.9025895f,   20.9343825f,   13.9597987f,    6.9809626f,
	       0.0000000f,   -6.9809626f,  -13.9597987f,  -20.9343825f,  -27.9025895f,  -34.8622971f,
	     -41.8113853f,  -48.7477374f,  -55.6692404f,  -62.5737860f,  -69.4592711f,  -76.3235981f,
	     -83.1646763f,  -89.9804217f,  -96.7687582f, -103.5276180f, -110.2549423f, -116.9486819f,
	    -123.6067977f, -130.2272618f, -136.8080573f, -143.3471798f, -149.8426374f, -156.2924514f,
	    -162.6946572f, -169.0473047f, -175.3484587f, -181.5961999f, -187.7886251f, -193.9238481f,
	    -200.0000000f, -206.0152300f, -211.9677057f, -217.8556140f, -223.6771614f, -229.4305745f,
	    -235.1141009f, -240.7260093f, -246.2645901f, -251.7281564f, -257.1150439f, -262.4236116f,
	    -267.6522425f, -272.7993440f, -277.8633482f, -282.8427125f, -287.7359201f, -292.5414806f,
	    -297.2579302f, -301.8838321f, -306.4177772f, -310.8583846f, -315.2043014f, -319.4542040f,
	    -323.6067977f, -327.6608177f, -331.6150290f, -335.4682272f, -339.2192385f, -342.8669203f
	};

const float vc_array[] = {
    346.4101615f, 342.8669203f, 339.2192385f, 335.4682272f, 331.6150290f, 327.6608177f,
    323.6067977f, 319.4542040f, 315.2043014f, 310.8583846f, 306.4177772f, 301.8838321f,
    297.2579302f, 292.5414806f, 287.7359201f, 282.8427125f, 277.8633482f, 272.7993440f,
    267.6522425f, 262.4236116f, 257.1150439f, 251.7281564f, 246.2645901f, 240.7260093f,
    235.1141009f, 229.4305745f, 223.6771614f, 217.8556140f, 211.9677057f, 206.0152300f,
    200.0000000f, 193.9238481f, 187.7886251f, 181.5961999f, 175.3484587f, 169.0473047f,
    162.6946572f, 156.2924514f, 149.8426374f, 143.3471798f, 136.8080573f, 130.2272618f,
    123.6067977f, 116.9486819f, 110.2549423f, 103.5276180f,  96.7687582f,  89.9804217f,
     83.1646763f,  76.3235982f,  69.4592711f,  62.5737860f,  55.6692404f,  48.7477374f,
     41.8113853f,  34.8622971f,  27.9025895f,  20.9343825f,  13.9597987f,   6.9809626f,
      0.0000000f,  -6.9809626f, -13.9597987f, -20.9343825f, -27.9025895f, -34.8622971f,
    -41.8113853f, -48.7477374f, -55.6692404f, -62.5737860f, -69.4592711f, -76.3235982f,
    -83.1646763f, -89.9804217f, -96.7687582f,-103.5276180f,-110.2549423f,-116.9486819f,
   -123.6067977f,-130.2272618f,-136.8080573f,-143.3471798f,-149.8426374f,-156.2924514f,
   -162.6946572f,-169.0473047f,-175.3484587f,-181.5961999f,-187.7886251f,-193.9238481f,
   -200.0000000f,-206.0152300f,-211.9677057f,-217.8556140f,-223.6771614f,-229.4305745f,
   -235.1141009f,-240.7260093f,-246.2645901f,-251.7281564f,-257.1150439f,-262.4236116f,
   -267.6522425f,-272.7993440f,-277.8633482f,-282.8427125f,-287.7359201f,-292.5414806f,
   -297.2579302f,-301.8838321f,-306.4177772f,-310.8583846f,-315.2043014f,-319.4542040f,
   -323.6067977f,-327.6608177f,-331.6150290f,-335.4682272f,-339.2192385f,-342.8669203f,
   -346.4101615f,-349.8478829f,-353.1790371f,-356.4026097f,-359.5176185f,-362.5231148f,
   -365.4181831f,-368.2019414f,-370.8735418f,-373.4321706f,-375.8770483f,-378.2074302f,
   -380.4226065f,-382.5219024f,-384.5046784f,-386.3703305f,-388.1182905f,-389.7480259f,
   -391.2590403f,-392.6508734f,-393.9231012f,-395.0753362f,-396.1072275f,-397.0184607f,
   -397.8087581f,-398.4778792f,-399.0256201f,-399.4518139f,-399.7563308f,-399.9390781f,
   -400.0000000f,-399.9390781f,-399.7563308f,-399.4518139f,-399.0256201f,-398.4778792f,
   -397.8087581f,-397.0184607f,-396.1072275f,-395.0753362f,-393.9231012f,-392.6508734f,
   -391.2590403f,-389.7480259f,-388.1182905f,-386.3703305f,-384.5046784f,-382.5219024f,
   -380.4226065f,-378.2074302f,-375.8770483f,-373.4321706f,-370.8735418f,-368.2019414f,
   -365.4181831f,-362.5231148f,-359.5176185f,-356.4026097f,-353.1790371f,-349.8478829f,
   -346.4101615f,-342.8669203f,-339.2192385f,-335.4682272f,-331.6150290f,-327.6608177f,
   -323.6067977f,-319.4542040f,-315.2043014f,-310.8583846f,-306.4177772f,-301.8838321f,
   -297.2579302f,-292.5414806f,-287.7359201f,-282.8427125f,-277.8633482f,-272.7993440f,
   -267.6522425f,-262.4236116f,-257.1150439f,-251.7281564f,-246.2645901f,-240.7260093f,
   -235.1141009f,-229.4305745f,-223.6771614f,-217.8556140f,-211.9677057f,-206.0152300f,
   -200.0000000f,-193.9238481f,-187.7886251f,-181.5961999f,-175.3484587f,-169.0473047f,
   -162.6946572f,-156.2924514f,-149.8426374f,-143.3471798f,-136.8080573f,-130.2272618f,
   -123.6067977f,-116.9486819f,-110.2549423f,-103.5276180f, -96.7687582f, -89.9804217f,
    -83.1646763f, -76.3235982f, -69.4592711f, -62.5737860f, -55.6692404f, -48.7477374f,
    -41.8113853f, -34.8622971f, -27.9025895f, -20.9343825f, -13.9597987f,  -6.9809626f,
      0.0000000f,   6.9809626f,  13.9597987f,  20.9343825f,  27.9025895f,  34.8622971f,
     41.8113853f,  48.7477374f,  55.6692404f,  62.5737860f,  69.4592711f,  76.3235982f,
     83.1646763f,  89.9804217f,  96.7687582f, 103.5276180f, 110.2549423f, 116.9486819f,
    123.6067977f, 130.2272618f, 136.8080573f, 143.3471798f, 149.8426374f, 156.2924514f,
    162.6946572f, 169.0473047f, 175.3484587f, 181.5961999f, 187.7886251f, 193.9238481f,
    200.0000000f, 206.0152300f, 211.9677057f, 217.8556140f, 223.6771614f, 229.4305745f,
    235.1141009f, 240.7260093f, 246.2645901f, 251.7281564f, 257.1150439f, 262.4236116f,
    267.6522425f, 272.7993440f, 277.8633482f, 282.8427125f, 287.7359201f, 292.5414806f,
    297.2579302f, 301.8838321f, 306.4177772f, 310.8583846f, 315.2043014f, 319.4542040f,
    323.6067977f, 327.6608177f, 331.6150290f, 335.4682272f, 339.2192385f, 342.8669203f,
    346.4101615f, 349.8478829f, 353.1790371f, 356.4026097f, 359.5176185f, 362.5231148f,
    365.4181831f, 368.2019414f, 370.8735418f, 373.4321706f, 375.8770483f, 378.2074302f,
    380.4226065f, 382.5219024f, 384.5046784f, 386.3703305f, 388.1182905f, 389.7480259f,
    391.2590403f, 392.6508734f, 393.9231012f, 395.0753362f, 396.1072275f, 397.0184607f,
    397.8087581f, 398.4778792f, 399.0256201f, 399.4518139f, 399.7563308f, 399.9390781f,
    400.0000000f, 399.9390781f, 399.7563308f, 399.4518139f, 399.0256201f, 398.4778792f,
    397.8087581f, 397.0184607f, 396.1072275f, 395.0753362f, 393.9231012f, 392.6508734f,
    391.2590403f, 389.7480259f, 388.1182905f, 386.3703305f, 384.5046784f, 382.5219024f,
    380.4226065f, 378.2074302f, 375.8770483f, 373.4321706f, 370.8735418f, 368.2019414f,
    365.4181831f, 362.5231148f, 359.5176185f, 356.4026097f, 353.1790371f, 349.8478829f
};

const float ia_array[360] = {
    0.0f, 1.745240644f, 3.48994967f, 5.233595624f, 6.975647374f, 8.715574275f,
    10.45284633f, 12.18693434f, 13.9173101f, 15.6434465f, 17.36481777f, 19.08089954f,
    20.79116908f, 22.49510543f, 24.19218956f, 25.88190451f, 27.56373558f, 29.23717047f,
    30.90169944f, 32.55681545f, 34.20201433f, 35.83679495f, 37.46065934f, 39.07311285f,
    40.67366431f, 42.26182617f, 43.83711468f, 45.39904997f, 46.94715628f, 48.48096202f,
    50.0f, 51.50380749f, 52.99192642f, 54.4639035f, 55.91929035f, 57.35764364f,
    58.77852523f, 60.18150232f, 61.56614753f, 62.9320391f, 64.27876097f, 65.6059029f,
    66.91306064f, 68.19983601f, 69.46583705f, 70.71067812f, 71.93398003f, 73.13537016f,
    74.31448255f, 75.47095802f, 76.60444431f, 77.71459615f, 78.80107536f, 79.863551f,
    80.90169944f, 81.91520443f, 82.90375726f, 83.86705679f, 84.80480962f, 85.71673007f,
    86.60254038f, 87.46197071f, 88.29475929f, 89.10065242f, 89.87940463f, 90.6307787f,
    91.35454576f, 92.05048535f, 92.71838546f, 93.35804265f, 93.96926208f, 94.55185756f,
    95.10565163f, 95.6304756f, 96.12616959f, 96.59258263f, 97.02957263f, 97.43700648f,
    97.81476007f, 98.16271834f, 98.4807753f, 98.76883406f, 99.02680687f, 99.25461516f,
    99.45218954f, 99.61946981f, 99.75640503f, 99.86295348f, 99.9390827f, 99.98476952f,
    100.0f, 99.98476952f, 99.9390827f, 99.86295348f, 99.75640503f, 99.61946981f,
    99.45218954f, 99.25461516f, 99.02680687f, 98.76883406f, 98.4807753f, 98.16271834f,
    97.81476007f, 97.43700648f, 97.02957263f, 96.59258263f, 96.12616959f, 95.6304756f,
    95.10565163f, 94.55185756f, 93.96926208f, 93.35804265f, 92.71838546f, 92.05048535f,
    91.35454576f, 90.6307787f, 89.87940463f, 89.10065242f, 88.29475929f, 87.46197071f,
    86.60254038f, 85.71673007f, 84.80480962f, 83.86705679f, 82.90375726f, 81.91520443f,
    80.90169944f, 79.863551f, 78.80107536f, 77.71459615f, 76.60444431f, 75.47095802f,
    74.31448255f, 73.13537016f, 71.93398003f, 70.71067812f, 69.46583705f, 68.19983601f,
    66.91306064f, 65.6059029f, 64.27876097f, 62.9320391f, 61.56614753f, 60.18150232f,
    58.77852523f, 57.35764364f, 55.91929035f, 54.4639035f, 52.99192642f, 51.50380749f,
    50.0f, 48.48096202f, 46.94715628f, 45.39904997f, 43.83711468f, 42.26182617f,
    40.67366431f, 39.07311285f, 37.46065934f, 35.83679495f, 34.20201433f, 32.55681545f,
    30.90169944f, 29.23717047f, 27.56373558f, 25.88190451f, 24.19218956f, 22.49510543f,
    20.79116908f, 19.08089954f, 17.36481777f, 15.6434465f, 13.9173101f, 12.18693434f,
    10.45284633f, 8.715574275f, 6.975647374f, 5.233595624f, 3.48994967f, 1.745240644f,
    1.22515e-14f, -1.745240644f, -3.48994967f, -5.233595624f, -6.975647374f,
    -8.715574275f, -10.45284633f, -12.18693434f, -13.9173101f, -15.6434465f,
    -17.36481777f, -19.08089954f, -20.79116908f, -22.49510543f, -24.19218956f,
    -25.88190451f, -27.56373558f, -29.23717047f, -30.90169944f, -32.55681545f,
    -34.20201433f, -35.83679495f, -37.46065934f, -39.07311285f, -40.67366431f,
    -42.26182617f, -43.83711468f, -45.39904997f, -46.94715628f, -48.48096202f,
    -50.0f, -51.50380749f, -52.99192642f, -54.4639035f, -55.91929035f,
    -57.35764364f, -58.77852523f, -60.18150232f, -61.56614753f, -62.9320391f,
    -64.27876097f, -65.6059029f, -66.91306064f, -68.19983601f, -69.46583705f,
    -70.71067812f, -71.93398003f, -73.13537016f, -74.31448255f, -75.47095802f,
    -76.60444431f, -77.71459615f, -78.80107536f, -79.863551f, -80.90169944f,
    -81.91520443f, -82.90375726f, -83.86705679f, -84.80480962f, -85.71673007f,
    -86.60254038f, -87.46197071f, -88.29475929f, -89.10065242f, -89.87940463f,
    -90.6307787f, -91.35454576f, -92.05048535f, -92.71838546f, -93.35804265f,
    -93.96926208f, -94.55185756f, -95.10565163f, -95.6304756f, -96.12616959f,
    -96.59258263f, -97.02957263f, -97.43700648f, -97.81476007f, -98.16271834f,
    -98.4807753f, -98.76883406f, -99.02680687f, -99.25461516f, -99.45218954f,
    -99.61946981f, -99.75640503f, -99.86295348f, -99.9390827f, -99.98476952f,
    -100.0f, -99.98476952f, -99.9390827f, -99.86295348f, -99.75640503f, -99.61946981f,
    -99.45218954f, -99.25461516f, -99.02680687f, -98.76883406f, -98.4807753f, -98.16271834f,
    -97.81476007f, -97.43700648f, -97.02957263f, -96.59258263f, -96.12616959f, -95.6304756f,
    -95.10565163f, -94.55185756f, -93.96926208f, -93.35804265f, -92.71838546f, -92.05048535f,
    -91.35454576f, -90.6307787f, -89.87940463f, -89.10065242f, -88.29475929f, -87.46197071f,
    -86.60254038f, -85.71673007f, -84.80480962f, -83.86705679f, -82.90375726f, -81.91520443f,
    -80.90169944f, -79.863551f, -78.80107536f, -77.71459615f, -76.60444431f, -75.47095802f,
    -74.31448255f, -73.13537016f, -71.93398003f, -70.71067812f, -69.46583705f, -68.19983601f,
    -66.91306064f, -65.6059029f, -64.27876097f, -62.9320391f, -61.56614753f, -60.18150232f,
    -58.77852523f, -57.35764364f, -55.91929035f, -54.4639035f, -52.99192642f, -51.50380749f,
    -50.0f, -48.48096202f, -46.94715628f, -45.39904997f, -43.83711468f, -42.26182617f,
    -40.67366431f, -39.07311285f, -37.46065934f, -35.83679495f, -34.20201433f, -32.55681545f,
    -30.90169944f, -29.23717047f, -27.56373558f, -25.88190451f, -24.19218956f, -22.49510543f,
    -20.79116908f, -19.08089954f, -17.36481777f, -15.6434465f, -13.9173101f, -12.18693434f,
    -10.45284633f, -8.715574275f, -6.975647374f, -5.233595624f, -3.48994967f, -1.745240644f
};


const float ib_array[360] = {
    -86.60254038f, -87.46197071f, -88.29475929f, -89.10065242f, -89.87940463f,
    -90.6307787f, -91.35454576f, -92.05048535f, -92.71838546f, -93.35804265f,
    -93.96926208f, -94.55185756f, -95.10565163f, -95.6304756f, -96.12616959f,
    -96.59258263f, -97.02957263f, -97.43700648f, -97.81476007f, -98.16271834f,
    -98.4807753f, -98.76883406f, -99.02680687f, -99.25461516f, -99.45218954f,
    -99.61946981f, -99.75640503f, -99.86295348f, -99.9390827f, -99.98476952f,
    -100.0f, -99.98476952f, -99.9390827f, -99.86295348f, -99.75640503f,
    -99.61946981f, -99.45218954f, -99.25461516f, -99.02680687f, -98.76883406f,
    -98.4807753f, -98.16271834f, -97.81476007f, -97.43700648f, -97.02957263f,
    -96.59258263f, -96.12616959f, -95.6304756f, -95.10565163f, -94.55185756f,
    -93.96926208f, -93.35804265f, -92.71838546f, -92.05048535f, -91.35454576f,
    -90.6307787f, -89.87940463f, -89.10065242f, -88.29475929f, -87.46197071f,
    -86.60254038f, -85.71673007f, -84.80480962f, -83.86705679f, -82.90375726f,
    -81.91520443f, -80.90169944f, -79.863551f, -78.80107536f, -77.71459615f,
    -76.60444431f, -75.47095802f, -74.31448255f, -73.13537016f, -71.93398003f,
    -70.71067812f, -69.46583705f, -68.19983601f, -66.91306064f, -65.6059029f,
    -64.27876097f, -62.9320391f, -61.56614753f, -60.18150232f, -58.77852523f,
    -57.35764364f, -55.91929035f, -54.4639035f, -52.99192642f, -51.50380749f,
    -50.0f, -48.48096202f, -46.94715628f, -45.39904997f, -43.83711468f,
    -42.26182617f, -40.67366431f, -39.07311285f, -37.46065934f, -35.83679495f,
    -34.20201433f, -32.55681545f, -30.90169944f, -29.23717047f, -27.56373558f,
    -25.88190451f, -24.19218956f, -22.49510543f, -20.79116908f, -19.08089954f,
    -17.36481777f, -15.6434465f, -13.9173101f, -12.18693434f, -10.45284633f,
    -8.715574275f, -6.975647374f, -5.233595624f, -3.48994967f, -1.745240644f,
    0.0f, 1.745240644f, 3.48994967f, 5.233595624f, 6.975647374f,
    8.715574275f, 10.45284633f, 12.18693434f, 13.9173101f, 15.6434465f,
    17.36481777f, 19.08089954f, 20.79116908f, 22.49510543f, 24.19218956f,
    25.88190451f, 27.56373558f, 29.23717047f, 30.90169944f, 32.55681545f,
    34.20201433f, 35.83679495f, 37.46065934f, 39.07311285f, 40.67366431f,
    42.26182617f, 43.83711468f, 45.39904997f, 46.94715628f, 48.48096202f,
    50.0f, 51.50380749f, 52.99192642f, 54.4639035f, 55.91929035f,
    57.35764364f, 58.77852523f, 60.18150232f, 61.56614753f, 62.9320391f,
    64.27876097f, 65.6059029f, 66.91306064f, 68.19983601f, 69.46583705f,
    70.71067812f, 71.93398003f, 73.13537016f, 74.31448255f, 75.47095802f,
    76.60444431f, 77.71459615f, 78.80107536f, 79.863551f, 80.90169944f,
    81.91520443f, 82.90375726f, 83.86705679f, 84.80480962f, 85.71673007f,
    86.60254038f, 87.46197071f, 88.29475929f, 89.10065242f, 89.87940463f,
    90.6307787f, 91.35454576f, 92.05048535f, 92.71838546f, 93.35804265f,
    93.96926208f, 94.55185756f, 95.10565163f, 95.6304756f, 96.12616959f,
    96.59258263f, 97.02957263f, 97.43700648f, 97.81476007f, 98.16271834f,
    98.4807753f, 98.76883406f, 99.02680687f, 99.25461516f, 99.45218954f,
    99.61946981f, 99.75640503f, 99.86295348f, 99.9390827f, 99.98476952f,
    100.0f, 99.98476952f, 99.9390827f, 99.86295348f, 99.75640503f,
    99.61946981f, 99.45218954f, 99.25461516f, 99.02680687f, 98.76883406f,
    98.4807753f, 98.16271834f, 97.81476007f, 97.43700648f, 97.02957263f,
    96.59258263f, 96.12616959f, 95.6304756f, 95.10565163f, 94.55185756f,
    93.96926208f, 93.35804265f, 92.71838546f, 92.05048535f, 91.35454576f,
    90.6307787f, 89.87940463f, 89.10065242f, 88.29475929f, 87.46197071f,
    86.60254038f, 85.71673007f, 84.80480962f, 83.86705679f, 82.90375726f,
    81.91520443f, 80.90169944f, 79.863551f, 78.80107536f, 77.71459615f,
    76.60444431f, 75.47095802f, 74.31448255f, 73.13537016f, 71.93398003f,
    70.71067812f, 69.46583705f, 68.19983601f, 66.91306064f, 65.6059029f,
    64.27876097f, 62.9320391f, 61.56614753f, 60.18150232f, 58.77852523f,
    57.35764364f, 55.91929035f, 54.4639035f, 52.99192642f, 51.50380749f,
    50.0f, 48.48096202f, 46.94715628f, 45.39904997f, 43.83711468f,
    42.26182617f, 40.67366431f, 39.07311285f, 37.46065934f, 35.83679495f,
    34.20201433f, 32.55681545f, 30.90169944f, 29.23717047f, 27.56373558f,
    25.88190451f, 24.19218956f, 22.49510543f, 20.79116908f, 19.08089954f,
    17.36481777f, 15.6434465f, 13.9173101f, 12.18693434f, 10.45284633f,
    8.715574275f, 6.975647374f, 5.233595624f, 3.48994967f, 1.745240644f,
    -3.21574e-14f, -1.745240644f, -3.48994967f, -5.233595624f, -6.975647374f,
    -8.715574275f, -10.45284633f, -12.18693434f, -13.9173101f, -15.6434465f,
    -17.36481777f, -19.08089954f, -20.79116908f, -22.49510543f, -24.19218956f,
    -25.88190451f, -27.56373558f, -29.23717047f, -30.90169944f, -32.55681545f,
    -34.20201433f, -35.83679495f, -37.46065934f, -39.07311285f, -40.67366431f,
    -42.26182617f, -43.83711468f, -45.39904997f, -46.94715628f, -48.48096202f,
    -50.0f, -51.50380749f, -52.99192642f, -54.4639035f, -55.91929035f,
    -57.35764364f, -58.77852523f, -60.18150232f, -61.56614753f, -62.9320391f,
    -64.27876097f, -65.6059029f, -66.91306064f, -68.19983601f, -69.46583705f,
    -70.71067812f, -71.93398003f, -73.13537016f, -74.31448255f, -75.47095802f,
    -76.60444431f, -77.71459615f, -78.80107536f, -79.863551f, -80.90169944f,
    -81.91520443f, -82.90375726f, -83.86705679f, -84.80480962f, -85.71673007f
};

const float ic_array[360] = {
    86.60254038f, 85.71673007f, 84.80480962f, 83.86705679f, 82.90375726f,
    81.91520443f, 80.90169944f, 79.863551f, 78.80107536f, 77.71459615f,
    76.60444431f, 75.47095802f, 74.31448255f, 73.13537016f, 71.93398003f,
    70.71067812f, 69.46583705f, 68.19983601f, 66.91306064f, 65.6059029f,
    64.27876097f, 62.9320391f, 61.56614753f, 60.18150232f, 58.77852523f,
    57.35764364f, 55.91929035f, 54.4639035f, 52.99192642f, 51.50380749f,
    50.0f, 48.48096202f, 46.94715628f, 45.39904997f, 43.83711468f,
    42.26182617f, 40.67366431f, 39.07311285f, 37.46065934f, 35.83679495f,
    34.20201433f, 32.55681545f, 30.90169944f, 29.23717047f, 27.56373558f,
    25.88190451f, 24.19218956f, 22.49510543f, 20.79116908f, 19.08089954f,
    17.36481777f, 15.6434465f, 13.9173101f, 12.18693434f, 10.45284633f,
    8.715574275f, 6.975647374f, 5.233595624f, 3.48994967f, 1.745240644f,
    -1.22515e-14f, -1.745240644f, -3.48994967f, -5.233595624f, -6.975647374f,
    -8.715574275f, -10.45284633f, -12.18693434f, -13.9173101f, -15.6434465f,
    -17.36481777f, -19.08089954f, -20.79116908f, -22.49510543f, -24.19218956f,
    -25.88190451f, -27.56373558f, -29.23717047f, -30.90169944f, -32.55681545f,
    -34.20201433f, -35.83679495f, -37.46065934f, -39.07311285f, -40.67366431f,
    -42.26182617f, -43.83711468f, -45.39904997f, -46.94715628f, -48.48096202f,
    -50.0f, -51.50380749f, -52.99192642f, -54.4639035f, -55.91929035f,
    -57.35764364f, -58.77852523f, -60.18150232f, -61.56614753f, -62.9320391f,
    -64.27876097f, -65.6059029f, -66.91306064f, -68.19983601f, -69.46583705f,
    -70.71067812f, -71.93398003f, -73.13537016f, -74.31448255f, -75.47095802f,
    -76.60444431f, -77.71459615f, -78.80107536f, -79.863551f, -80.90169944f,
    -81.91520443f, -82.90375726f, -83.86705679f, -84.80480962f, -85.71673007f,
    -86.60254038f, -87.46197071f, -88.29475929f, -89.10065242f, -89.87940463f,
    -90.6307787f, -91.35454576f, -92.05048535f, -92.71838546f, -93.35804265f,
    -93.96926208f, -94.55185756f, -95.10565163f, -95.6304756f, -96.12616959f,
    -96.59258263f, -97.02957263f, -97.43700648f, -97.81476007f, -98.16271834f,
    -98.4807753f, -98.76883406f, -99.02680687f, -99.25461516f, -99.45218954f,
    -99.61946981f, -99.75640503f, -99.86295348f, -99.9390827f, -99.98476952f,
    -100.0f, -99.98476952f, -99.9390827f, -99.86295348f, -99.75640503f,
    -99.61946981f, -99.45218954f, -99.25461516f, -99.02680687f, -98.76883406f,
    -98.4807753f, -98.16271834f, -97.81476007f, -97.43700648f, -97.02957263f,
    -96.59258263f, -96.12616959f, -95.6304756f, -95.10565163f, -94.55185756f,
    -93.96926208f, -93.35804265f, -92.71838546f, -92.05048535f, -91.35454576f,
    -90.6307787f, -89.87940463f, -89.10065242f, -88.29475929f, -87.46197071f,
    -86.60254038f, -85.71673007f, -84.80480962f, -83.86705679f, -82.90375726f,
    -81.91520443f, -80.90169944f, -79.863551f, -78.80107536f, -77.71459615f,
    -76.60444431f, -75.47095802f, -74.31448255f, -73.13537016f, -71.93398003f,
    -70.71067812f, -69.46583705f, -68.19983601f, -66.91306064f, -65.6059029f,
    -64.27876097f, -62.9320391f, -61.56614753f, -60.18150232f, -58.77852523f,
    -57.35764364f, -55.91929035f, -54.4639035f, -52.99192642f, -51.50380749f,
    -50.0f, -48.48096202f, -46.94715628f, -45.39904997f, -43.83711468f,
    -42.26182617f, -40.67366431f, -39.07311285f, -37.46065934f, -35.83679495f,
    -34.20201433f, -32.55681545f, -30.90169944f, -29.23717047f, -27.56373558f,
    -25.88190451f, -24.19218956f, -22.49510543f, -20.79116908f, -19.08089954f,
    -17.36481777f, -15.6434465f, -13.9173101f, -12.18693434f, -10.45284633f,
    -8.715574275f, -6.975647374f, -5.233595624f, -3.48994967f, -1.745240644f,
    0.0f, 1.745240644f, 3.48994967f, 5.233595624f, 6.975647374f,
    8.715574275f, 10.45284633f, 12.18693434f, 13.9173101f, 15.6434465f,
    17.36481777f, 19.08089954f, 20.79116908f, 22.49510543f, 24.19218956f,
    25.88190451f, 27.56373558f, 29.23717047f, 30.90169944f, 32.55681545f,
    34.20201433f, 35.83679495f, 37.46065934f, 39.07311285f, 40.67366431f,
    42.26182617f, 43.83711468f, 45.39904997f, 46.94715628f, 48.48096202f,
    50.0f, 51.50380749f, 52.99192642f, 54.4639035f, 55.91929035f,
    57.35764364f, 58.77852523f, 60.18150232f, 61.56614753f, 62.9320391f,
    64.27876097f, 65.6059029f, 66.91306064f, 68.19983601f, 69.46583705f,
    70.71067812f, 71.93398003f, 73.13537016f, 74.31448255f, 75.47095802f,
    76.60444431f, 77.71459615f, 78.80107536f, 79.863551f, 80.90169944f,
    81.91520443f, 82.90375726f, 83.86705679f, 84.80480962f, 85.71673007f,
    86.60254038f, 87.46197071f, 88.29475929f, 89.10065242f, 89.87940463f,
    90.6307787f, 91.35454576f, 92.05048535f, 92.71838546f, 93.35804265f,
    93.96926208f, 94.55185756f, 95.10565163f, 95.6304756f, 96.12616959f,
    96.59258263f, 97.02957263f, 97.43700648f, 97.81476007f, 98.16271834f,
    98.4807753f, 98.76883406f, 99.02680687f, 99.25461516f, 99.45218954f,
    99.61946981f, 99.75640503f, 99.86295348f, 99.9390827f, 99.98476952f,
    100.0f, 99.98476952f, 99.9390827f, 99.86295348f, 99.75640503f,
    99.61946981f, 99.45218954f, 99.25461516f, 99.02680687f, 98.76883406f,
    98.4807753f, 98.16271834f, 97.81476007f, 97.43700648f, 97.02957263f,
    96.59258263f, 96.12616959f, 95.6304756f, 95.10565163f, 94.55185756f,
    93.96926208f, 93.35804265f, 92.71838546f, 92.05048535f, 91.35454576f,
    90.6307787f, 89.87940463f, 89.10065242f, 88.29475929f, 87.46197071f
};







//const float va_array[] = {
//    0.0f, 3.926791448f, 7.852386758f, 11.77559015f, 15.69520659f,
//    19.61004212f, 23.51890424f, 27.42060227f, 31.31394772f, 35.19775463f,
//    39.07083998f, 42.93202396f, 46.78013043f, 50.61398723f, 54.43242651f,
//    58.23428515f, 62.01840506f, 65.78363356f, 69.52882373f, 73.25283475f,
//    76.95453225f, 80.63278865f, 84.28648352f, 87.91450391f, 91.51574469f,
//    95.08910889f, 98.63350803f, 102.1478624f, 105.6311016f, 109.0821646f,
//    112.5f, 115.8835669f, 119.2318345f, 122.5437829f, 125.8184033f,
//    129.0546982f, 132.2516818f, 135.4083802f, 138.5238319f, 141.597088f,
//    144.6272122f, 147.6132815f, 150.5543864f, 153.449631f, 156.2981334f,
//    159.0990258f, 161.8514551f, 164.5545829f, 167.2075857f, 169.8096556f,
//    172.3599997f, 174.8578413f, 177.3024196f, 179.6929898f, 182.0288237f,
//    184.30921f, 186.5334538f, 188.7008778f, 190.8108216f, 192.8626427f,
//    194.8557159f, 196.7894341f, 198.6632084f, 200.4764679f, 202.2286604f,
//    203.9192521f, 205.547728f, 207.113592f, 208.6163673f, 210.055596f,
//    211.4308397f, 212.7416795f, 213.9877162f, 215.1685701f, 216.2838816f,
//    217.3333109f, 218.3165384f, 219.2332646f, 220.0832102f, 220.8661163f,
//    221.5817444f, 222.2298766f, 222.8103155f, 223.3228841f, 223.7674265f,
//    224.1438071f, 224.4519113f, 224.6916453f, 224.8629361f, 224.9657314f,
//    225.0f, 224.9657314f, 224.8629361f, 224.6916453f, 224.4519113f,
//    224.1438071f, 223.7674265f, 223.3228841f, 222.8103155f, 222.2298766f,
//    221.5817444f, 220.8661163f, 220.0832102f, 219.2332646f, 218.3165384f,
//    217.3333109f, 216.2838816f, 215.1685701f, 213.9877162f, 212.7416795f,
//    211.4308397f, 210.055596f, 208.6163673f, 207.113592f, 205.547728f,
//    203.9192521f, 202.2286604f, 200.4764679f, 198.6632084f, 196.7894341f,
//    194.8557159f, 192.8626427f, 190.8108216f, 188.7008778f, 186.5334538f,
//    184.30921f, 182.0288237f, 179.6929898f, 177.3024196f, 174.8578413f,
//    172.3599997f, 169.8096556f, 167.2075857f, 164.5545829f, 161.8514551f,
//    159.0990258f, 156.2981334f, 153.449631f, 150.5543864f, 147.6132815f,
//    144.6272122f, 141.597088f, 138.5238319f, 135.4083802f, 132.2516818f,
//    129.0546982f, 125.8184033f, 122.5437829f, 119.2318345f, 115.8835669f,
//    112.5f, 109.0821646f, 105.6311016f, 102.1478624f, 98.63350803f,
//    95.08910889f, 91.51574469f, 87.91450391f, 84.28648352f, 80.63278865f,
//    76.95453225f, 73.25283475f, 69.52882373f, 65.78363356f, 62.01840506f,
//    58.23428515f, 54.43242651f, 50.61398723f, 46.78013043f, 42.93202396f,
//    39.07083998f, 35.19775463f, 31.31394772f, 27.42060227f, 23.51890424f,
//    19.61004212f, 15.69520659f, 11.77559015f, 7.852386758f, 3.926791448f,
//    0.0f, -3.926791448f, -7.852386758f, -11.77559015f, -15.69520659f,
//    -19.61004212f, -23.51890424f, -27.42060227f, -31.31394772f, -35.19775463f,
//    -39.07083998f, -42.93202396f, -46.78013043f, -50.61398723f, -54.43242651f,
//    -58.23428515f, -62.01840506f, -65.78363356f, -69.52882373f, -73.25283475f,
//    -76.95453225f, -80.63278865f, -84.28648352f, -87.91450391f, -91.51574469f,
//    -95.08910889f, -98.63350803f, -102.1478624f, -105.6311016f, -109.0821646f,
//    -112.5f, -115.8835669f, -119.2318345f, -122.5437829f, -125.8184033f,
//    -129.0546982f, -132.2516818f, -135.4083802f, -138.5238319f, -141.597088f,
//    -144.6272122f, -147.6132815f, -150.5543864f, -153.449631f, -156.2981334f,
//    -159.0990258f, -161.8514551f, -164.5545829f, -167.2075857f, -169.8096556f,
//    -172.3599997f, -174.8578413f, -177.3024196f, -179.6929898f, -182.0288237f,
//    -184.30921f, -186.5334538f, -188.7008778f, -190.8108216f, -192.8626427f,
//    -194.8557159f, -196.7894341f, -198.6632084f, -200.4764679f, -202.2286604f,
//    -203.9192521f, -205.547728f, -207.113592f, -208.6163673f, -210.055596f,
//    -211.4308397f, -212.7416795f, -213.9877162f, -215.1685701f, -216.2838816f,
//    -217.3333109f, -218.3165384f, -219.2332646f, -220.0832102f, -220.8661163f,
//    -221.5817444f, -222.2298766f, -222.8103155f, -223.3228841f, -223.7674265f,
//    -224.1438071f, -224.4519113f, -224.6916453f, -224.8629361f, -224.9657314f,
//    -225.0f, -224.9657314f, -224.8629361f, -224.6916453f, -224.4519113f,
//    -224.1438071f, -223.7674265f, -223.3228841f, -222.8103155f, -222.2298766f,
//    -221.5817444f, -220.8661163f, -220.0832102f, -219.2332646f, -218.3165384f,
//    -217.3333109f, -216.2838816f, -215.1685701f, -213.9877162f, -212.7416795f,
//    -211.4308397f, -210.055596f, -208.6163673f, -207.113592f, -205.547728f,
//    -203.9192521f, -202.2286604f, -200.4764679f, -198.6632084f, -196.7894341f,
//    -194.8557159f, -192.8626427f, -190.8108216f, -188.7008778f, -186.5334538f,
//    -184.30921f, -182.0288237f, -179.6929898f, -177.3024196f, -174.8578413f,
//    -172.3599997f, -169.8096556f, -167.2075857f, -164.5545829f, -161.8514551f,
//    -159.0990258f, -156.2981334f, -153.449631f, -150.5543864f, -147.6132815f,
//    -144.6272122f, -141.597088f, -138.5238319f, -135.4083802f, -132.2516818f,
//    -129.0546982f, -125.8184033f, -122.5437829f, -119.2318345f, -115.8835669f,
//    -112.5f, -109.0821646f, -105.6311016f, -102.1478624f, -98.63350803f,
//    -95.08910889f, -91.51574469f, -87.91450391f, -84.28648352f, -80.63278865f,
//    -76.95453225f, -73.25283475f, -69.52882373f, -65.78363356f, -62.01840506f,
//    -58.23428515f, -54.43242651f, -50.61398723f, -46.78013043f, -42.93202396f,
//    -39.07083998f, -35.19775463f, -31.31394772f, -27.42060227f, -23.51890424f,
//    -19.61004212f, -15.69520659f, -11.77559015f, -7.852386758f, -3.926791448f
//};
//
//
//const float vb_array[] = {
//    -194.8557159f, -196.7894341f, -198.6632084f, -200.4764679f, -202.2286604f,
//    -203.9192521f, -205.547728f, -207.113592f, -208.6163673f, -210.055596f,
//    -211.4308397f, -212.7416795f, -213.9877162f, -215.1685701f, -216.2838816f,
//    -217.3333109f, -218.3165384f, -219.2332646f, -220.0832102f, -220.8661163f,
//    -221.5817444f, -222.2298766f, -222.8103155f, -223.3228841f, -223.7674265f,
//    -224.1438071f, -224.4519113f, -224.6916453f, -224.8629361f, -224.9657314f,
//    -225.0f, -224.9657314f, -224.8629361f, -224.6916453f, -224.4519113f,
//    -224.1438071f, -223.7674265f, -223.3228841f, -222.8103155f, -222.2298766f,
//    -221.5817444f, -220.8661163f, -220.0832102f, -219.2332646f, -218.3165384f,
//    -217.3333109f, -216.2838816f, -215.1685701f, -213.9877162f, -212.7416795f,
//    -211.4308397f, -210.055596f, -208.6163673f, -207.113592f, -205.547728f,
//    -203.9192521f, -202.2286604f, -200.4764679f, -198.6632084f, -196.7894341f,
//    -194.8557159f, -192.8626427f, -190.8108216f, -188.7008778f, -186.5334538f,
//    -184.30921f, -182.0288237f, -179.6929898f, -177.3024196f, -174.8578413f,
//    -172.3599997f, -169.8096556f, -167.2075857f, -164.5545829f, -161.8514551f,
//    -159.0990258f, -156.2981334f, -153.449631f, -150.5543864f, -147.6132815f,
//    -144.6272122f, -141.597088f, -138.5238319f, -135.4083802f, -132.2516818f,
//    -129.0546982f, -125.8184033f, -122.5437829f, -119.2318345f, -115.8835669f,
//    -112.5f, -109.0821646f, -105.6311016f, -102.1478624f, -98.63350803f,
//    -95.08910889f, -91.51574469f, -87.91450391f, -84.28648352f, -80.63278865f,
//    -76.95453225f, -73.25283475f, -69.52882373f, -65.78363356f, -62.01840506f,
//    -58.23428515f, -54.43242651f, -50.61398723f, -46.78013043f, -42.93202396f,
//    -39.07083998f, -35.19775463f, -31.31394772f, -27.42060227f, -23.51890424f,
//    -19.61004212f, -15.69520659f, -11.77559015f, -7.852386758f, -3.926791448f,
//    0.0f, 3.926791448f, 7.852386758f, 11.77559015f, 15.69520659f,
//    19.61004212f, 23.51890424f, 27.42060227f, 31.31394772f, 35.19775463f,
//    39.07083998f, 42.93202396f, 46.78013043f, 50.61398723f, 54.43242651f,
//    58.23428515f, 62.01840506f, 65.78363356f, 69.52882373f, 73.25283475f,
//    76.95453225f, 80.63278865f, 84.28648352f, 87.91450391f, 91.51574469f,
//    95.08910889f, 98.63350803f, 102.1478624f, 105.6311016f, 109.0821646f,
//    112.5f, 115.8835669f, 119.2318345f, 122.5437829f, 125.8184033f,
//    129.0546982f, 132.2516818f, 135.4083802f, 138.5238319f, 141.597088f,
//    144.6272122f, 147.6132815f, 150.5543864f, 153.449631f, 156.2981334f,
//    159.0990258f, 161.8514551f, 164.5545829f, 167.2075857f, 169.8096556f,
//    172.3599997f, 174.8578413f, 177.3024196f, 179.6929898f, 182.0288237f,
//    184.30921f, 186.5334538f, 188.7008778f, 190.8108216f, 192.8626427f,
//    194.8557159f, 196.7894341f, 198.6632084f, 200.4764679f, 202.2286604f,
//    203.9192521f, 205.547728f, 207.113592f, 208.6163673f, 210.055596f,
//    211.4308397f, 212.7416795f, 213.9877162f, 215.1685701f, 216.2838816f,
//    217.3333109f, 218.3165384f, 219.2332646f, 220.0832102f, 220.8661163f,
//    221.5817444f, 222.2298766f, 222.8103155f, 223.3228841f, 223.7674265f,
//    224.1438071f, 224.4519113f, 224.6916453f, 224.8629361f, 224.9657314f,
//    225.0f, 224.9657314f, 224.8629361f, 224.6916453f, 224.4519113f,
//    224.1438071f, 223.7674265f, 223.3228841f, 222.8103155f, 222.2298766f,
//    221.5817444f, 220.8661163f, 220.0832102f, 219.2332646f, 218.3165384f,
//    217.3333109f, 216.2838816f, 215.1685701f, 213.9877162f, 212.7416795f,
//    211.4308397f, 210.055596f, 208.6163673f, 207.113592f, 205.547728f,
//    203.9192521f, 202.2286604f, 200.4764679f, 198.6632084f, 196.7894341f,
//    194.8557159f, 192.8626427f, 190.8108216f, 188.7008778f, 186.5334538f,
//    184.30921f, 182.0288237f, 179.6929898f, 177.3024196f, 174.8578413f,
//    172.3599997f, 169.8096556f, 167.2075857f, 164.5545829f, 161.8514551f,
//    159.0990258f, 156.2981334f, 153.449631f, 150.5543864f, 147.6132815f,
//    144.6272122f, 141.597088f, 138.5238319f, 135.4083802f, 132.2516818f,
//    129.0546982f, 125.8184033f, 122.5437829f, 119.2318345f, 115.8835669f,
//    112.5f, 109.0821646f, 105.6311016f, 102.1478624f, 98.63350803f,
//    95.08910889f, 91.51574469f, 87.91450391f, 84.28648352f, 80.63278865f,
//    76.95453225f, 73.25283475f, 69.52882373f, 65.78363356f, 62.01840506f,
//    58.23428515f, 54.43242651f, 50.61398723f, 46.78013043f, 42.93202396f,
//    39.07083998f, 35.19775463f, 31.31394772f, 27.42060227f, 23.51890424f,
//    19.61004212f, 15.69520659f, 11.77559015f, 7.852386758f, 3.926791448f,
//    0.0f, -3.926791448f, -7.852386758f, -11.77559015f, -15.69520659f,
//    -19.61004212f, -23.51890424f, -27.42060227f, -31.31394772f, -35.19775463f,
//    -39.07083998f, -42.93202396f, -46.78013043f, -50.61398723f, -54.43242651f,
//    -58.23428515f, -62.01840506f, -65.78363356f, -69.52882373f, -73.25283475f,
//    -76.95453225f, -80.63278865f, -84.28648352f, -87.91450391f, -91.51574469f,
//    -95.08910889f, -98.63350803f, -102.1478624f, -105.6311016f, -109.0821646f,
//    -112.5f, -115.8835669f, -119.2318345f, -122.5437829f, -125.8184033f,
//    -129.0546982f, -132.2516818f, -135.4083802f, -138.5238319f, -141.597088f,
//    -144.6272122f, -147.6132815f, -150.5543864f, -153.449631f, -156.2981334f,
//    -159.0990258f, -161.8514551f, -164.5545829f, -167.2075857f, -169.8096556f,
//    -172.3599997f, -174.8578413f, -177.3024196f, -179.6929898f, -182.0288237f,
//    -184.30921f, -186.5334538f, -188.7008778f, -190.8108216f, -192.8626427f
//};
//
//
//const float vc_array[] = {
//    194.8557159f, 192.8626427f, 190.8108216f, 188.7008778f, 186.5334538f,
//    184.30921f, 182.0288237f, 179.6929898f, 177.3024196f, 174.8578413f,
//    172.3599997f, 169.8096556f, 167.2075857f, 164.5545829f, 161.8514551f,
//    159.0990258f, 156.2981334f, 153.449631f, 150.5543864f, 147.6132815f,
//    144.6272122f, 141.597088f, 138.5238319f, 135.4083802f, 132.2516818f,
//    129.0546982f, 125.8184033f, 122.5437829f, 119.2318345f, 115.8835669f,
//    112.5f, 109.0821646f, 105.6311016f, 102.1478624f, 98.63350803f,
//    95.08910889f, 91.51574469f, 87.91450391f, 84.28648352f, 80.63278865f,
//    76.95453225f, 73.25283475f, 69.52882373f, 65.78363356f, 62.01840506f,
//    58.23428515f, 54.43242651f, 50.61398723f, 46.78013043f, 42.93202396f,
//    39.07083998f, 35.19775463f, 31.31394772f, 27.42060227f, 23.51890424f,
//    19.61004212f, 15.69520659f, 11.77559015f, 7.852386758f, 3.926791448f,
//    0.0f, -3.926791448f, -7.852386758f, -11.77559015f, -15.69520659f,
//    -19.61004212f, -23.51890424f, -27.42060227f, -31.31394772f, -35.19775463f,
//    -39.07083998f, -42.93202396f, -46.78013043f, -50.61398723f, -54.43242651f,
//    -58.23428515f, -62.01840506f, -65.78363356f, -69.52882373f, -73.25283475f,
//    -76.95453225f, -80.63278865f, -84.28648352f, -87.91450391f, -91.51574469f,
//    -95.08910889f, -98.63350803f, -102.1478624f, -105.6311016f, -109.0821646f,
//    -112.5f, -115.8835669f, -119.2318345f, -122.5437829f, -125.8184033f,
//    -129.0546982f, -132.2516818f, -135.4083802f, -138.5238319f, -141.597088f,
//    -144.6272122f, -147.6132815f, -150.5543864f, -153.449631f, -156.2981334f,
//    -159.0990258f, -161.8514551f, -164.5545829f, -167.2075857f, -169.8096556f,
//    -172.3599997f, -174.8578413f, -177.3024196f, -179.6929898f, -182.0288237f,
//    -184.30921f, -186.5334538f, -188.7008778f, -190.8108216f, -192.8626427f,
//    -194.8557159f, -196.7894341f, -198.6632084f, -200.4764679f, -202.2286604f,
//    -203.9192521f, -205.547728f, -207.113592f, -208.6163673f, -210.055596f,
//    -211.4308397f, -212.7416795f, -213.9877162f, -215.1685701f, -216.2838816f,
//    -217.3333109f, -218.3165384f, -219.2332646f, -220.0832102f, -220.8661163f,
//    -221.5817444f, -222.2298766f, -222.8103155f, -223.3228841f, -223.7674265f,
//    -224.1438071f, -224.4519113f, -224.6916453f, -224.8629361f, -224.9657314f,
//    -225.0f, -224.9657314f, -224.8629361f, -224.6916453f, -224.4519113f,
//    -224.1438071f, -223.7674265f, -223.3228841f, -222.8103155f, -222.2298766f,
//    -221.5817444f, -220.8661163f, -220.0832102f, -219.2332646f, -218.3165384f,
//    -217.3333109f, -216.2838816f, -215.1685701f, -213.9877162f, -212.7416795f,
//    -211.4308397f, -210.055596f, -208.6163673f, -207.113592f, -205.547728f,
//    -203.9192521f, -202.2286604f, -200.4764679f, -198.6632084f, -196.7894341f
//};










